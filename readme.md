Задача: создатькод для новых виджетов системы Искра.

Все виджетысделаны на чистом JavaScript без использования сторонних фрэймворков. Никакиедополнительные файлы (js/стили) не должны загружаться. При запуске виджетапроисходит проверка того, что виджет не был запущен ранее.

 

**1. Блок отзывов о товаре**

 

Состав:JS-код, PHP-обработчик, MySQL-таблица для отзывов.

Примервёрстки прилагается.

 

Виджетполучает ID товара из атрибута *content*тэга *meta[name="iskra-page-offer"]*и формирует блок отзывов о товаре в HTML-блоке с *id="iskra-feedback"*. Если блока нет, то будет выданопредупреждение в console.log. Ключ сайта берется из параметра *key* тэга *script[src\*= 'stcl.js']*.

 

Призагрузке виджета происходит асинхронный запрос на сервер и получение перечняотзывов для данного ID товара и ключа сайта. При добавлении отзыва на серверпередается оценка (1-5 звёзд), текст отзыва, ID товара и ключ сайта.

 

Конфигурация:URL серверной части, ID тэгов, количество показанных отзывов, возможностьсамостоятельно оставлять отзыв задается в коде виджета через константы.

 

Требованиек PHP-бэкенду: отдает список отзывов с оценками и принимает новые отзывы длязаданного ключа и ID товара. Хранит в таблице поле *allowed* (тип enum) с информацией о возможности показа отзыва (т.е.любой отзыв можно открыть или закрыть для показа). Имеет настройку, позволяющуюустанавливать allowed='Yes' или allowed='No' по умолчанию для каждого ключа.

 

 

**2. Сборщик email-адресов**

 

Состав:JS-код.

Вёрсткаделается самостоятельно.

 

Приинициализации виджета начинается контроль действий пользователя.

Придолгой неактивности или скроллинге на самый верх после скроллинга вниз, либопри перемещении курсора в верхний левый или правый угол экрана появляется окнос предложением оставить свой email и подписаться на рассылку.

Приоставлении email происходит вызов

 

if (stcl && stcl.target)

  stcl.target("Подпискана рассылку", {"Email":client@email.com});

 

иокно закрывается.

 

Конфигурация:стили окна, необходимость контроля скорллинга, неактивности или перемещениякурсора задаются в начале кода виджета через константы.

 

 

**3. Картинка при первом входе**

 

Состав:JS-код.

Вёрсткаделается самостоятельно.

 

Приинициализации виджета появляется pop-up картинка с крестиком в случае, если неустановлена cookie iskra_popup_[MD5(url_картинки)]. Вместо MD5 можноиспользовать любую хэш-функцию.

Призакрытии окна устанавливается данная cookie, тем самым блокируя показы той жекартинки при следующем заходе пользователя.

 

Конфигурация:url_картинки, стили и местоположение pop-up (слева/справа/по центру,вверху/внизу/по центру) задаются в начале кода виджета через константы.

 

 

**4. Звонок с сайта**

 

Состав:JS-код, PHP-обработчик, MySQL-таблица с логом запросов.

Вёрсткаделается самостоятельно.

 

Приинициализации виджета появляется картинка с телефоном (картинку выбратьсамостоятельно и согласовать). При наведении на картинку возможна какая-тоанимация.

 

Принажатии на картинку появляется панель с предложением ввести номер телефона ивыбором времени звонка. В случае возможности заказать звонок прямо сейчас такжеотображается количество секунд для обратного отсчета. При заказе звонка"прямо сейчас" счетчик секунд начинает отсчет и доходит до 0, послечего появляется слово «Звонок».

 

Конфигурация:время суток по дням недели для отображения картинки и для выбора в меню, атакже изначальное значение счетчика при звонке "прямо сейчас"задаются в начале кода виджета через константы.

 

PHP-бэкендполучает запрос с ключом, временем звонка и номером телефона и отправляетписьмо на указанный для данного ключа email.

 

 